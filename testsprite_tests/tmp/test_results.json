[
  {
    "projectId": "2b5df877-1f27-4edc-9a2d-ce398e0ebe5d",
    "testId": "15b424b0-7a6e-4521-bbff-8d15bc877823",
    "userId": "349894c8-00c1-70bb-1d4b-604845cb7503",
    "title": "TC001-initiate github oauth flow",
    "description": "Test the GET /api/v1/auth/github endpoint to ensure it correctly initiates the GitHub OAuth flow by redirecting the user to the GitHub authorization page.",
    "code": "import requests\n\ndef test_initiate_github_oauth_flow():\n    base_url = \"http://localhost:5000\"\n    endpoint = \"/api/v1/auth/github\"\n    url = base_url + endpoint\n    timeout = 30\n\n    try:\n        response = requests.get(url, allow_redirects=False, timeout=timeout)\n    except requests.RequestException as e:\n        assert False, f\"Request to initiate GitHub OAuth flow failed: {e}\"\n\n    # Assert that the response status code is 302 (redirect)\n    assert response.status_code == 302, (\n        f\"Expected status code 302 for redirect but got {response.status_code}\"\n    )\n\n    # Assert that the Location header is present and points to github.com (authorization page)\n    location = response.headers.get(\"Location\")\n    assert location is not None, \"Redirect response missing Location header\"\n    assert \"github.com/login/oauth/authorize\" in location or \"github.com\" in location, (\n        f\"Redirect Location header does not appear to be GitHub OAuth URL: {location}\"\n    )\n\ntest_initiate_github_oauth_flow()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 26, in <module>\n  File \"<string>\", line 15, in test_initiate_github_oauth_flow\nAssertionError: Expected status code 302 for redirect but got 200\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-09-07T16:54:46.536Z",
    "modified": "2025-09-07T16:55:22.768Z"
  },
  {
    "projectId": "2b5df877-1f27-4edc-9a2d-ce398e0ebe5d",
    "testId": "098fa762-6909-456b-b2dd-d17a0cc9eb7c",
    "userId": "349894c8-00c1-70bb-1d4b-604845cb7503",
    "title": "TC002-handle github oauth callback",
    "description": "Test the GET /api/v1/auth/github/callback endpoint to verify it correctly handles the OAuth callback from GitHub, processes the authorization code, and redirects to the frontend with a valid authentication token.",
    "code": "import requests\nfrom urllib.parse import urlparse, parse_qs\n\nBASE_URL = \"http://localhost:5000\"\nTIMEOUT = 30\n\ndef test_handle_github_oauth_callback():\n    \"\"\"\n    Test the GET /api/v1/auth/github/callback endpoint to verify it correctly handles\n    the OAuth callback from GitHub, processes the authorization code, and redirects\n    to the frontend with a valid authentication token.\n    \"\"\"\n\n    # Simulate an authorization code received from GitHub OAuth redirect\n    # For testing, use a dummy 'code' value (in real world, this would be from GitHub).\n    dummy_auth_code = \"dummy_authorization_code\"\n\n    callback_url = f\"{BASE_URL}/api/v1/auth/github/callback?code={dummy_auth_code}\"\n\n    try:\n        response = requests.get(callback_url, timeout=TIMEOUT, allow_redirects=False)\n    except requests.RequestException as e:\n        raise AssertionError(f\"Request to OAuth callback endpoint failed: {e}\")\n\n    # The expected behavior:\n    # - HTTP 302 status code with Location header redirecting to frontend URL with auth token.\n    assert response.status_code == 302, f\"Expected status code 302 for redirect, got {response.status_code}\"\n\n    location = response.headers.get(\"Location\")\n    assert location is not None, \"Redirect response missing Location header\"\n\n    # Parsing the redirect URL to verify it contains an authentication token (e.g., in query or fragment)\n    parsed_url = urlparse(location)\n    \n    # The frontend URL should be a valid redirect and contain token in query or fragment\n    query_params = parse_qs(parsed_url.query)\n    fragment_params = parse_qs(parsed_url.fragment)\n\n    token_found = False\n    # Check possible locations for an auth token parameter, common param names: token, access_token, auth_token\n    for param_set in (query_params, fragment_params):\n        for key in (\"token\", \"access_token\", \"auth_token\", \"jwt\"):\n            if key in param_set and param_set[key]:\n                token_found = True\n                token_value = param_set[key][0]\n                # Basic validation: token value should be a non-empty string\n                assert isinstance(token_value, str) and len(token_value) > 0, \"Authentication token is invalid or empty\"\n                break\n        if token_found:\n            break\n    \n    assert token_found, f\"No authentication token found in redirect URL: {location}\"\n\ntest_handle_github_oauth_callback()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 54, in <module>\n  File \"<string>\", line 27, in test_handle_github_oauth_callback\nAssertionError: Expected status code 302 for redirect, got 400\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-09-07T16:54:46.542Z",
    "modified": "2025-09-07T16:55:22.755Z"
  },
  {
    "projectId": "2b5df877-1f27-4edc-9a2d-ce398e0ebe5d",
    "testId": "3284424f-6f52-4673-9b83-2bc5f16eac57",
    "userId": "349894c8-00c1-70bb-1d4b-604845cb7503",
    "title": "TC003-get current authenticated user",
    "description": "Test the GET /api/v1/auth/me endpoint to ensure it returns the authenticated user's information when provided with a valid token, and returns 401 Unauthorized when no or invalid token is provided.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:5000\"\nTIMEOUT = 30\n\n\ndef test_get_current_authenticated_user():\n    # Setup: obtain a valid token for testing.\n    # Replace the token below with a valid one from your authentication process.\n    valid_token = \"your_valid_token_here\"\n\n    headers_valid = {\n        \"Authorization\": f\"Bearer {valid_token}\"\n    }\n    headers_invalid = {\n        \"Authorization\": \"Bearer invalid_or_expired_token\"\n    }\n\n    # 1. Test with valid token (expect 200 and user info)\n    try:\n        response = requests.get(f\"{BASE_URL}/api/v1/auth/me\", headers=headers_valid, timeout=TIMEOUT)\n        assert response.status_code == 200, f\"Expected 200 OK, got {response.status_code}\"\n        json_data = response.json()\n        # Basic validation of user info structure\n        assert isinstance(json_data, dict), \"Response is not a JSON object\"\n        assert \"id\" in json_data or \"username\" in json_data or \"email\" in json_data, \"User information missing expected fields\"\n    except requests.RequestException as e:\n        assert False, f\"Request to /api/v1/auth/me with valid token failed: {e}\"\n\n    # 2. Test with no token (expect 401)\n    try:\n        response_no_token = requests.get(f\"{BASE_URL}/api/v1/auth/me\", timeout=TIMEOUT)\n        assert response_no_token.status_code == 401, f\"Expected 401 Unauthorized for no token, got {response_no_token.status_code}\"\n    except requests.RequestException as e:\n        assert False, f\"Request to /api/v1/auth/me with no token failed: {e}\"\n\n    # 3. Test with invalid token (expect 401)\n    try:\n        response_invalid_token = requests.get(f\"{BASE_URL}/api/v1/auth/me\", headers=headers_invalid, timeout=TIMEOUT)\n        assert response_invalid_token.status_code == 401, f\"Expected 401 Unauthorized for invalid token, got {response_invalid_token.status_code}\"\n    except requests.RequestException as e:\n        assert False, f\"Request to /api/v1/auth/me with invalid token failed: {e}\"\n\n\ntest_get_current_authenticated_user()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 45, in <module>\n  File \"<string>\", line 22, in test_get_current_authenticated_user\nAssertionError: Expected 200 OK, got 401\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-09-07T16:54:46.548Z",
    "modified": "2025-09-07T16:55:33.372Z"
  },
  {
    "projectId": "2b5df877-1f27-4edc-9a2d-ce398e0ebe5d",
    "testId": "d2350318-ca54-4937-9ed5-4e6331761f41",
    "userId": "349894c8-00c1-70bb-1d4b-604845cb7503",
    "title": "TC004-refresh access token",
    "description": "Test the POST /api/v1/auth/refresh endpoint to verify it accepts a valid refresh token and returns a new access token, and returns 401 Unauthorized for invalid or expired refresh tokens.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:5000\"\nREFRESH_ENDPOINT = \"/api/v1/auth/refresh\"\nTIMEOUT = 30\n\ndef test_refresh_access_token():\n    valid_refresh_token = \"valid-refresh-token-example\"\n    invalid_refresh_token = \"invalid-or-expired-refresh-token\"\n\n    headers = {\n        \"Content-Type\": \"application/json\"\n    }\n\n    # Test with valid refresh token\n    try:\n        response = requests.post(\n            BASE_URL + REFRESH_ENDPOINT,\n            json={\"refreshToken\": valid_refresh_token},\n            headers=headers,\n            timeout=TIMEOUT\n        )\n        assert response.status_code == 200, f\"Expected 200 OK, got {response.status_code}\"\n        json_body = response.json()\n        assert \"accessToken\" in json_body and isinstance(json_body[\"accessToken\"], str) and json_body[\"accessToken\"], \"New access token missing or invalid in response\"\n    except requests.RequestException as e:\n        assert False, f\"Request with valid refresh token failed: {e}\"\n\n    # Test with invalid or expired refresh token\n    try:\n        response = requests.post(\n            BASE_URL + REFRESH_ENDPOINT,\n            json={\"refreshToken\": invalid_refresh_token},\n            headers=headers,\n            timeout=TIMEOUT\n        )\n        assert response.status_code == 401, f\"Expected 401 Unauthorized for invalid refresh token, got {response.status_code}\"\n    except requests.RequestException as e:\n        assert False, f\"Request with invalid refresh token failed: {e}\"\n\ntest_refresh_access_token()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 41, in <module>\n  File \"<string>\", line 23, in test_refresh_access_token\nAssertionError: Expected 200 OK, got 403\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-09-07T16:54:46.554Z",
    "modified": "2025-09-07T16:55:22.769Z"
  },
  {
    "projectId": "2b5df877-1f27-4edc-9a2d-ce398e0ebe5d",
    "testId": "19ce8f49-bfba-40cf-93d1-918c2813d12d",
    "userId": "349894c8-00c1-70bb-1d4b-604845cb7503",
    "title": "TC005-logout user and invalidate tokens",
    "description": "Test the POST /api/v1/auth/logout endpoint to ensure it successfully logs out the user by invalidating tokens and returns a 200 status indicating successful logout.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:5000\"\nTIMEOUT = 30\n\ndef test_logout_user_and_invalidate_tokens():\n    session = requests.Session()\n    try:\n        # Authenticate user to get tokens (simulate login)\n        # Here we simulate login by calling /api/v1/auth/github/callback or a similar endpoint\n        # Since no login endpoint with username/password is provided, assume a token is obtained manually or via environment variable\n        # For demonstration, assume an access token and refresh token are known (replace with valid tokens for real test)\n        access_token = \"PLACE_VALID_ACCESS_TOKEN_HERE\"\n        refresh_token = \"PLACE_VALID_REFRESH_TOKEN_HERE\"\n\n        # Use the access token in Authorization header\n        headers = {\n            \"Authorization\": f\"Bearer {access_token}\"\n        }\n\n        # Call logout endpoint\n        response = session.post(\n            f\"{BASE_URL}/api/v1/auth/logout\",\n            headers=headers,\n            timeout=TIMEOUT\n        )\n\n        # Assert logout success\n        assert response.status_code == 200, f\"Expected 200 OK but got {response.status_code}\"\n        # Optionally validate response content if API returns a message\n        # Example: assert response.json().get(\"message\") == \"Logout successful\"\n    except requests.RequestException as e:\n        assert False, f\"Request failed: {e}\"\n\ntest_logout_user_and_invalidate_tokens()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 35, in <module>\n  File \"<string>\", line 29, in test_logout_user_and_invalidate_tokens\nAssertionError: Expected 200 OK but got 403\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-09-07T16:54:46.560Z",
    "modified": "2025-09-07T16:55:20.290Z"
  },
  {
    "projectId": "2b5df877-1f27-4edc-9a2d-ce398e0ebe5d",
    "testId": "0e7cd71e-338e-471f-80e6-9cfc84c59bb1",
    "userId": "349894c8-00c1-70bb-1d4b-604845cb7503",
    "title": "TC006-list authenticated user github repositories",
    "description": "Test the GET /api/v1/github/repos endpoint to verify it returns a list of repositories accessible by the authenticated user, and returns 401 Unauthorized if the user is not authenticated.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:5000\"\nREPOS_ENDPOINT = \"/api/v1/github/repos\"\nTIMEOUT = 30\n\n# Placeholder token for authenticated requests - replace with a valid token for actual tests\nAUTH_TOKEN = \"Bearer your_valid_jwt_token_here\"\n\ndef test_list_authenticated_user_github_repositories():\n    headers_auth = {\n        \"Authorization\": AUTH_TOKEN,\n        \"Accept\": \"application/json\"\n    }\n    headers_no_auth = {\n        \"Accept\": \"application/json\"\n    }\n\n    # Test case: Authenticated request returns list of repositories\n    try:\n        response = requests.get(\n            BASE_URL + REPOS_ENDPOINT,\n            headers=headers_auth,\n            timeout=TIMEOUT\n        )\n    except requests.RequestException as e:\n        assert False, f\"Authenticated request failed with exception: {e}\"\n\n    assert response.status_code == 200, f\"Expected 200 OK, got {response.status_code}\"\n    # Expect response JSON to be a list or dict with repositories data\n    try:\n        repos = response.json()\n    except ValueError:\n        assert False, \"Response is not valid JSON\"\n    assert isinstance(repos, (list, dict)), \"Response JSON is not a list or dict of repositories\"\n\n    # Test case: Unauthenticated request returns 401 Unauthorized\n    try:\n        response_unauth = requests.get(\n            BASE_URL + REPOS_ENDPOINT,\n            headers=headers_no_auth,\n            timeout=TIMEOUT\n        )\n    except requests.RequestException as e:\n        assert False, f\"Unauthenticated request failed with exception: {e}\"\n\n    assert response_unauth.status_code == 401, f\"Expected 401 Unauthorized, got {response_unauth.status_code}\"\n\ntest_list_authenticated_user_github_repositories()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 49, in <module>\n  File \"<string>\", line 29, in test_list_authenticated_user_github_repositories\nAssertionError: Expected 200 OK, got 401\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-09-07T16:54:46.566Z",
    "modified": "2025-09-07T16:55:22.771Z"
  },
  {
    "projectId": "2b5df877-1f27-4edc-9a2d-ce398e0ebe5d",
    "testId": "51294675-e612-4bf8-9ed2-8409b5ca74e0",
    "userId": "349894c8-00c1-70bb-1d4b-604845cb7503",
    "title": "TC007-get files from github repository",
    "description": "Test the GET /api/v1/github/files endpoint with valid repo and optional path parameters to ensure it returns the list of files in the specified repository path, returns 404 if the repository or path is not found, and 401 if unauthorized.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:5000\"\nTIMEOUT = 30\n\n# Provide a valid OAuth token for authorization here\nTOKEN = \"your_valid_github_oauth_token\"\n\ndef test_get_files_from_github_repository():\n    headers = {\n        \"Authorization\": f\"Bearer {TOKEN}\",\n        \"Accept\": \"application/json\"\n    }\n\n    repo = \"octocat/Hello-World\"  # Example known public repository\n    path = \"docs\"  # Optional path example that may or may not exist\n\n    # 1. Test response with repo only (root path)\n    params = {\"repo\": repo}\n    resp = requests.get(f\"{BASE_URL}/api/v1/github/files\", headers=headers, params=params, timeout=TIMEOUT)\n    assert resp.status_code in (200, 404), f\"Expected 200 or 404, got {resp.status_code}\"\n    if resp.status_code == 200:\n        json_data = resp.json()\n        assert isinstance(json_data, list), \"Response should be a list of files\"\n\n    # 2. Test successful response with repo and valid path\n    params = {\"repo\": repo, \"path\": path}\n    resp = requests.get(f\"{BASE_URL}/api/v1/github/files\", headers=headers, params=params, timeout=TIMEOUT)\n    if resp.status_code == 200:\n        json_data = resp.json()\n        assert isinstance(json_data, list), \"Response should be a list of files\"\n    else:\n        # Path may not exist; 404 acceptable here\n        assert resp.status_code == 404 or resp.status_code == 200, f\"Expected 200 or 404, got {resp.status_code}\"\n\n    # 3. Test 404 response for non-existent repo\n    params = {\"repo\": \"thisuser/thisrepodoesnotexist1234567890\"}\n    resp = requests.get(f\"{BASE_URL}/api/v1/github/files\", headers=headers, params=params, timeout=TIMEOUT)\n    assert resp.status_code == 404, f\"Expected 404 for non-existent repo, got {resp.status_code}\"\n\n    # 4. Test 404 response for non-existent path in a valid repo\n    params = {\"repo\": repo, \"path\": \"nonexistent/path/to/files\"}\n    resp = requests.get(f\"{BASE_URL}/api/v1/github/files\", headers=headers, params=params, timeout=TIMEOUT)\n    assert resp.status_code == 404, f\"Expected 404 for non-existent path, got {resp.status_code}\"\n\n    # 5. Test 401 unauthorized with no or invalid token\n    headers_unauth = {\"Authorization\": \"Bearer invalidtoken123\"}\n    params = {\"repo\": repo}\n    resp = requests.get(f\"{BASE_URL}/api/v1/github/files\", headers=headers_unauth, params=params, timeout=TIMEOUT)\n    assert resp.status_code in (401, 404), f\"Expected 401 or 404 unauthorized, got {resp.status_code}\"\n\n    headers_no_auth = {\"Accept\": \"application/json\"}\n    resp = requests.get(f\"{BASE_URL}/api/v1/github/files\", headers=headers_no_auth, params=params, timeout=TIMEOUT)\n    assert resp.status_code in (401, 404), f\"Expected 401 or 404 without token, got {resp.status_code}\"\n\ntest_get_files_from_github_repository()\n",
    "testStatus": "PASSED",
    "testError": "",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-09-07T16:54:46.572Z",
    "modified": "2025-09-07T16:56:18.153Z"
  },
  {
    "projectId": "2b5df877-1f27-4edc-9a2d-ce398e0ebe5d",
    "testId": "b9e064ca-60e5-4dca-817e-f060929691c7",
    "userId": "349894c8-00c1-70bb-1d4b-604845cb7503",
    "title": "TC008-generate test cases for selected files",
    "description": "Test the POST /api/v1/testcases/generate endpoint by submitting a valid repository and list of files, verifying that it returns generated test cases, and returns 400 for invalid requests or 401 if unauthorized.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:5000\"\nTIMEOUT = 30\n\n# Replace this with a valid token for authentication\nAUTH_TOKEN = \"your_valid_jwt_token_here\"\n\ndef test_generate_test_cases_for_selected_files():\n    headers = {\n        \"Authorization\": f\"Bearer {AUTH_TOKEN}\",\n        \"Content-Type\": \"application/json\"\n    }\n\n    valid_payload = {\n        \"repo\": \"example-repo\",\n        \"files\": [\n            \"src/module1.py\",\n            \"src/utils/helper.py\"\n        ]\n    }\n\n    # Test success case with valid repo and files\n    response = requests.post(\n        f\"{BASE_URL}/api/v1/testcases/generate\",\n        json=valid_payload,\n        headers=headers,\n        timeout=TIMEOUT\n    )\n\n    assert response.status_code == 200, f\"Expected status 200, got {response.status_code}\"\n    json_response = response.json()\n    assert isinstance(json_response, dict), \"Response should be a JSON object\"\n    # Minimal check: response contains generated test cases key or similar structure\n    # This key name is unknown from PRD, so we check if keys exist and response is not empty\n    assert json_response, \"Response should contain generated test cases data\"\n\n    # Test error case: invalid request (missing files)\n    invalid_payload = {\n        \"repo\": \"example-repo\"\n        # Missing 'files' key\n    }\n\n    response_400 = requests.post(\n        f\"{BASE_URL}/api/v1/testcases/generate\",\n        json=invalid_payload,\n        headers=headers,\n        timeout=TIMEOUT\n    )\n    assert response_400.status_code == 400, f\"Expected status 400, got {response_400.status_code}\"\n\n    # Test error case: unauthorized (no auth header)\n    response_401 = requests.post(\n        f\"{BASE_URL}/api/v1/testcases/generate\",\n        json=valid_payload,\n        timeout=TIMEOUT\n    )\n    assert response_401.status_code == 401, f\"Expected status 401, got {response_401.status_code}\"\n\ntest_generate_test_cases_for_selected_files()\n",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 60, in <module>\n  File \"<string>\", line 31, in test_generate_test_cases_for_selected_files\nAssertionError: Expected status 200, got 403\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-09-07T16:54:46.579Z",
    "modified": "2025-09-07T16:55:52.458Z"
  },
  {
    "projectId": "2b5df877-1f27-4edc-9a2d-ce398e0ebe5d",
    "testId": "8ebfe19a-b52b-4c15-bec8-cd711f83262c",
    "userId": "349894c8-00c1-70bb-1d4b-604845cb7503",
    "title": "TC009-save edited test cases",
    "description": "Test the POST /api/v1/testcases/save endpoint to ensure it saves the edited test cases correctly and returns a 200 status, and returns 401 if the user is unauthorized.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:5000\"\nTIMEOUT = 30\n\n# Replace this with a valid auth token for the authorized test\nAUTH_TOKEN = \"your_valid_jwt_token_here\"\n\n\ndef test_save_edited_testcases():\n    url = f\"{BASE_URL}/api/v1/testcases/save\"\n    headers_authorized = {\n        \"Authorization\": f\"Bearer {AUTH_TOKEN}\",\n        \"Content-Type\": \"application/json\"\n    }\n    headers_unauthorized = {\n        \"Content-Type\": \"application/json\"\n    }\n\n    # Send empty JSON payload as no schema is specified\n    payload = {}\n\n    # Test authorized request - expect 200\n    try:\n        response = requests.post(url, json=payload, headers=headers_authorized, timeout=TIMEOUT)\n    except requests.RequestException as e:\n        assert False, f\"RequestException during authorized request: {e}\"\n    assert response.status_code == 200, f\"Expected status 200, got {response.status_code}\"\n    # We don't assert on response body because PRD does not specify schema\n\n    # Test unauthorized request - expect 401\n    try:\n        response_unauth = requests.post(url, json=payload, headers=headers_unauthorized, timeout=TIMEOUT)\n    except requests.RequestException as e:\n        assert False, f\"RequestException during unauthorized request: {e}\"\n    assert response_unauth.status_code == 401, f\"Expected status 401 for unauthorized, got {response_unauth.status_code}\"\n\n\ntest_save_edited_testcases()\n",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 39, in <module>\n  File \"<string>\", line 28, in test_save_edited_testcases\nAssertionError: Expected status 200, got 403\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-09-07T16:54:46.585Z",
    "modified": "2025-09-07T16:55:53.164Z"
  },
  {
    "projectId": "2b5df877-1f27-4edc-9a2d-ce398e0ebe5d",
    "testId": "5ef35f08-7452-446c-b1b9-5b5bd0a78ac4",
    "userId": "349894c8-00c1-70bb-1d4b-604845cb7503",
    "title": "TC010-create pull request with generated tests",
    "description": "Test the POST /api/v1/github/create-pr endpoint by submitting valid repository, branch, title, description, and files, verifying that it creates a pull request successfully with a 201 status, and returns 400 for invalid requests or 401 if unauthorized.",
    "code": "import requests\n\nBASE_URL = \"http://localhost:5000\"\nTIMEOUT = 30\n\n# Dummy valid authentication token for authorization header\n# Replace with a valid token for actual testing\nAUTH_TOKEN = \"Bearer your_valid_token_here\"\n\ndef test_create_pull_request_with_generated_tests():\n    url = f\"{BASE_URL}/api/v1/github/create-pr\"\n    headers = {\n        \"Authorization\": AUTH_TOKEN,\n        \"Content-Type\": \"application/json\"\n    }\n\n    valid_payload = {\n        \"repo\": \"example-repo\",\n        \"branch\": \"feature/test-generation\",\n        \"title\": \"Add generated tests for feature X\",\n        \"description\": \"This pull request adds generated test cases for feature X using AI analysis.\",\n        \"files\": [\n            {\"path\": \"tests/test_feature_x.py\", \"content\": \"def test_feature_x(): assert True\"},\n            {\"path\": \"tests/test_utils.py\", \"content\": \"def test_utils(): assert 1 == 1\"}\n        ]\n    }\n\n    invalid_payload = {\n        # Missing repository field to trigger 400\n        \"branch\": \"feature/test-generation\",\n        \"title\": \"Invalid PR\",\n        \"description\": \"Missing repo field\",\n        \"files\": []\n    }\n\n    # 1) Test successful pull request creation\n    response = requests.post(url, json=valid_payload, headers=headers, timeout=TIMEOUT)\n    try:\n        assert response.status_code == 201, f\"Expected 201, got {response.status_code}\"\n        json_data = response.json()\n        # Assuming response contains at least 'id' or 'url' for the created PR\n        assert \"id\" in json_data or \"url\" in json_data, \"Response missing 'id' or 'url' field\"\n    except Exception:\n        # Raise detailed error for debugging\n        raise\n\n    # 2) Test invalid request (400) with missing repo field\n    response_invalid = requests.post(url, json=invalid_payload, headers=headers, timeout=TIMEOUT)\n    try:\n        assert response_invalid.status_code == 400, f\"Expected 400 for invalid request, got {response_invalid.status_code}\"\n    except Exception:\n        raise\n\n    # 3) Test unauthorized request (401) with missing or invalid token\n    headers_unauth = {\n        \"Content-Type\": \"application/json\"\n    }\n    response_unauth = requests.post(url, json=valid_payload, headers=headers_unauth, timeout=TIMEOUT)\n    try:\n        assert response_unauth.status_code == 401, f\"Expected 401 for unauthorized request, got {response_unauth.status_code}\"\n    except Exception:\n        raise\n\n\ntest_create_pull_request_with_generated_tests()",
    "testStatus": "FAILED",
    "testError": "Traceback (most recent call last):\n  File \"/var/task/handler.py\", line 258, in run_with_retry\n    exec(code, exec_env)\n  File \"<string>\", line 65, in <module>\n  File \"<string>\", line 39, in test_create_pull_request_with_generated_tests\nAssertionError: Expected 201, got 403\n",
    "testType": "BACKEND",
    "createFrom": "mcp",
    "created": "2025-09-07T16:54:46.592Z",
    "modified": "2025-09-07T16:55:31.443Z"
  }
]
